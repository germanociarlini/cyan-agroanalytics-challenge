(this["webpackJsonpcyan-frontend-challenge"]=this["webpackJsonpcyan-frontend-challenge"]||[]).push([[0],{116:function(e,t,n){},148:function(e,t,n){},150:function(e,t,n){},151:function(e,t,n){},259:function(e,t,n){},260:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),o=n(25),a=n.n(o),i=(n(116),n(6)),u=n(4),s=n.n(u),l=n(9),j=n(28),f=n(27),b=n(40),d=n.n(b),p=Object(c.createContext)(null),O=Object(c.createContext)([]),h=n(8),v=n(103),x=n.n(v).a.create({baseURL:"http://localhost:3001"}),m=function(e){var t=e.toGeoJSON();return t.properties=Object(h.a)({},e.options),t},y=function(){var e=Object(l.a)(s.a.mark((function e(t){var n,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("/collections/".concat(t.id,"/features"));case 2:return n=e.sent,c={type:"FeatureCollection",features:n.data.map((function(e){return{type:"Feature",properties:Object(h.a)({},e.properties),geometry:e.geometry}}))},e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=(n(148),n(3)),_=function(e){var t=e.isOpen,n=e.onRequestClose,c=e.content;return Object(C.jsxs)(d.a,{className:"modal__content",isOpen:t,onRequestClose:n,style:{overlay:{zIndex:1001},content:{zIndex:1001}},children:[Object(C.jsx)(f.a,{icon:j.c,className:"modal__close-button",onClick:n}),c]})},g=(n(77),n(150),function(e){var t=e.onLoad,n=Object(c.useState)([]),r=Object(i.a)(n,2),o=r[0],a=r[1],u=Object(c.useState)(null),j=Object(i.a)(u,2),f=j[0],b=j[1];Object(c.useEffect)((function(){(function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("/collections");case 2:t=e.sent,a(t.data.map((function(e){return Object(h.a)(Object(h.a)({},e),{},{updatedAt:new Date(e.updatedAt.replace(" ","T"))})})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var d=function(){t(f)};return Object(C.jsxs)("div",{className:"load-modal__content",children:[Object(C.jsx)("header",{className:"modal__header",children:Object(C.jsx)("h2",{children:"Load Feature Collection"})}),Object(C.jsx)("main",{className:"load-modal__collection-list",children:o.map((function(e){return Object(C.jsxs)("div",{className:"load-modal__collection-item ".concat(e===f?"selected":""),onClick:function(){return function(e){b(e)}(e)},onDoubleClick:d,children:[Object(C.jsx)("span",{children:e.name}),Object(C.jsx)("span",{children:e.updatedAt.toLocaleString("default")})]},e.id)}))}),Object(C.jsx)("footer",{children:Object(C.jsx)("button",{className:"modal__button",onClick:d,disabled:null===f,children:"Load Collection"})})]})}),w=(n(151),function(e){var t=e.onSaveAs,n=e.onOverwrite,r=Object(c.useContext)(p).collection,o=Object(c.useState)(""),a=Object(i.a)(o,2),u=a[0],s=a[1];Object(c.useEffect)((function(){s(r?r.name:"")}),[r]);return Object(C.jsxs)("div",{className:"save-modal__content",children:[Object(C.jsx)("header",{children:Object(C.jsx)("h2",{children:"Save Feature Collection"})}),Object(C.jsx)("main",{children:Object(C.jsx)("input",{className:"save-modal__input",type:"text",value:u,placeholder:"MyCollection...",autoFocus:!0,onChange:function(e){return t=e.target.value,void s(t);var t}})}),Object(C.jsxs)("footer",{children:[r&&Object(C.jsx)("button",{className:"modal__button",disabled:0===u.length,onClick:function(){n(u,r)},children:"Overwrite..."}),Object(C.jsx)("button",{className:"modal__button",disabled:0===u.length,onClick:function(){t(u)},children:"Save as..."})]})]})}),k=function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.put("/collections",{name:t});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(l.a)(s.a.mark((function e(t,n){var c,r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="/collections/".concat(n.id),r={name:t},e.next=4,x.put(c,r);case 4:return o=e.sent,e.abrupt("return",o.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(s.a.mark((function e(t,n){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="/collections/".concat(t,"/features"),e.next=3,x.put(c,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();d.a.setAppElement(document.getElementById("root"));var L=function(){var e=Object(c.useState)(null),t=Object(i.a)(e,2),n=t[0],r=t[1],o=Object(c.useContext)(p),a=o.collection,u=o.setCollection,b=Object(c.useContext)(O).layers,d=function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t);case 2:n=e.sent,v(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(l.a)(s.a.mark((function e(t,n){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t,n);case 2:c=e.sent,v(c);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(l.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=b.map((function(e){return m(e)})),e.next=3,N(t.id,n);case 3:e.sent&&(r(null),u(t));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(null),u(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=Object(C.jsx)(w,{onSaveAs:d,onOverwrite:h}),L=Object(C.jsx)(g,{onLoad:function(e){return x(e)}}),E=a?"Editing ".concat(a.name):"New Collection";return Object(C.jsxs)("div",{className:"collection-controller__container",children:[Object(C.jsx)("span",{className:"collection-controller__editing-label",children:E}),Object(C.jsxs)("div",{className:"collection-controller_toolbar",children:[Object(C.jsx)("div",{className:"collection-controller_toolbar-button",onClick:function(){return r(y)},children:Object(C.jsx)(f.a,{icon:j.b})}),Object(C.jsx)("div",{className:"collection-controller_toolbar-button",onClick:function(){return r(L)},children:Object(C.jsx)(f.a,{icon:j.a})}),Object(C.jsx)(_,{isOpen:null!==n,onRequestClose:function(){return r(null)},content:n})]})]})},E=n(109),F=n(265),A=n(267),D=n(266),P=n(7),z=n.n(P),I=n(108),M=n(262),J=n(263),R=n(264),T=n(110),Z={default:{color:"#000",opacity:.9,fillOpacity:.5,weight:1},polyline:{color:"#000",opacity:.7,weight:4}},q=function(e){var t=e.onCreate,n=e.onEdit,r=e.onDelete,o=Object(c.useState)(null),a=Object(i.a)(o,2),u=a[0],j=a[1],f=Object(c.useState)(null),b=Object(i.a)(f,2),d=b[0],v=b[1],x=Object(c.useState)(Z.default.color),m=Object(i.a)(x,2),_=m[0],g=m[1],w=Object(c.useContext)(p).collection,k=Object(c.useContext)(O).setLayers;Object(M.a)({click:function(){v(null)}}),Object(c.useEffect)((function(){null===u||void 0===u||u.clearLayers(),w?function(){var e=Object(l.a)(s.a.mark((function e(t){var n,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,y(t);case 3:c=e.sent,new z.a.GeoJSON(c,{style:function(e){return Object(h.a)({},e.properties)}}).eachLayer((function(e){u.addLayer(e),e.on({click:function(e){v(e.target),g(e.target.options.color)}}),n.push(e)})),k(n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(w):k([])}),[w]);return Object(C.jsxs)(J.a,{ref:function(e){var t;null!==(t=e)&&j(t)},children:[Object(C.jsx)(T.a,{position:"topright",onCreated:function(e){var n=e.layer,c="polyline"===e.layerType?Z.polyline:Z.default;n.setStyle(c),n.on({click:function(e){v(e.target),g(e.target.options.color)}}),t(n)},onEdited:function(e){var t=Object.values(e.layers._layers);n(t)},onDeleted:function(e){var t=Object.keys(e.layers._layers).map((function(e){return+e}));r(t)},draw:{circlemarker:!1,marker:!1,circle:!1}}),Object(C.jsx)(R.a,{children:Object(C.jsx)(I.a,{triangle:"hide",color:_,onChangeComplete:function(e){var t=e.hex;d.setStyle(Object(h.a)(Object(h.a)({},d.options),{},{color:t})),g(t),n([d])}})})]})},B=(n(259),{initialPosition:[-3.731862,-38.526669],initialZoom:12,enableZoomControl:!1}),G=function(){var e=Object(c.useContext)(O).setLayers;return Object(C.jsxs)(F.a,{center:B.initialPosition,zoom:B.initialZoom,zoomControl:B.enableZoomControl,children:[Object(C.jsx)(A.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(C.jsx)(D.a,{position:"bottomleft"}),Object(C.jsx)(q,{onCreate:function(t){return function(t){e((function(e){return[].concat(Object(E.a)(e),[t])}))}(t)},onEdit:function(t){return function(t){e((function(e){return e.map((function(e){return Object.assign(e,t.find((function(t){return t._leaflet_id===e._leaflet_id})))}))}))}(t)},onDelete:function(t){return n=t,void e((function(e){return e.filter((function(e){return!n.includes(e._leaflet_id)}))}));var n}})]})},U=function(){var e=Object(c.useState)(null),t=Object(i.a)(e,2),n=t[0],r=t[1],o=Object(c.useState)([]),a=Object(i.a)(o,2),u=a[0],s=a[1],l=Object(c.useMemo)((function(){return{collection:n,setCollection:r}}),[n,r]),j=Object(c.useMemo)((function(){return{layers:u,setLayers:s}}),[u,s]);return Object(C.jsx)("div",{className:"App",children:Object(C.jsx)(p.Provider,{value:l,children:Object(C.jsxs)(O.Provider,{value:j,children:[Object(C.jsx)(L,{}),Object(C.jsx)(G,{})]})})})},H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,268)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),o(e),a(e)}))};a.a.render(Object(C.jsx)(r.a.StrictMode,{children:Object(C.jsx)(U,{})}),document.getElementById("root")),H()},77:function(e,t,n){}},[[260,1,2]]]);
//# sourceMappingURL=main.02920924.chunk.js.map